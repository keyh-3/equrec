<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes">

<title>360 Viewer (Mouse Only)</title>

<!-- Three.js r145 -->
<script src="https://unpkg.com/three@0.145.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.145.0/examples/js/controls/OrbitControls.js"></script>

<style>
body {
  margin: 0;
  background: #000;
}
#can {
  width: 300px;
  height: 180px;
  cursor: grab;
}
</style>
</head>

<body>

<canvas id="can"></canvas>

<script>
let scene, camera, renderer, controls;

function main() {

  scene = new THREE.Scene();

  const canvas = document.getElementById("can");
  const w = canvas.clientWidth;
  const h = canvas.clientHeight;

  // カメラ
  camera = new THREE.PerspectiveCamera(30, w / h, 0.1, 10000);
  camera.position.set(0, 0, 0.001);
  scene.add(camera);

  // レンダラー
  renderer = new THREE.WebGLRenderer({
    canvas: canvas,
    antialias: true
  });
  renderer.setSize(w, h);
  renderer.setClearColor(0x444444, 1);

  // 360°テクスチャ
  const texture = new THREE.TextureLoader().load("equirectangular_image.jpg");
  const sphereGeo = new THREE.SphereGeometry(1, 32, 24);
  const sphereMat = new THREE.MeshBasicMaterial({
    map: texture,
    side: THREE.BackSide
  });

  const sphere = new THREE.Mesh(sphereGeo, sphereMat);
  scene.add(sphere);

  // OrbitControls（マウス操作）
  controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.target.set(0, 0, 0);
  controls.enablePan = false;
  controls.enableZoom = false;
  controls.rotateSpeed = 0.4;
  controls.update();

  animate();
}

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}

window.addEventListener("DOMContentLoaded", main);
</script>

</body>
</html>
